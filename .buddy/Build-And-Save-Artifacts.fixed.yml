- pipeline: "Build And Save Artifacts"
  events:
  - type: "PUSH"
    refs:
    - "refs/heads/main"
  fail_on_prepare_env_warning: true
  actions:
  - action: "Deploy Clean Artifact"
    type: "BUILD"
    docker_image_name: "library/maven"
    docker_image_tag: "3.8.6"
    execute_commands:
    - "echo '<settings xmlns=\"http://maven.apache.org/SETTINGS/1.0.0\""
    - "          xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\""
    - "          xsi:schemaLocation=\"http://maven.apache.org/SETTINGS/1.0.0"
    - "                              https://maven.apache.org/xsd/settings-1.0.0.xsd\">"
    - ""
    - "    <profiles>"
    - "        <profile>"
    - "            <id>josephredmond-profile</id>"
    - "            <repositories>"
    - "                <repository>"
    - "                    <id>josephredmond-releases</id>"
    - "                    <url>https://artifacts.josephredmond.com/repository/maven-releases/</url>"
    - "                    <releases>"
    - "                        <enabled>true</enabled>"
    - "                    </releases>"
    - "                    <snapshots>"
    - "                        <enabled>true</enabled>"
    - "                    </snapshots>"
    - "                </repository>"
    - "                <repository>"
    - "                    <id>spring-milestones</id>"
    - "                    <url>https://repo.spring.io/milestone</url>"
    - "                    <releases>"
    - "                        <enabled>true</enabled>"
    - "                    </releases>"
    - "                    <snapshots>"
    - "                        <enabled>false</enabled>"
    - "                    </snapshots>"
    - "                </repository>"
    - "            </repositories>"
    - "            <pluginRepositories>"
    - "                <pluginRepository>"
    - "                    <id>josephredmond-plugins</id>"
    - "                    <url>https://artifacts.josephredmond.com/repository/maven-releases/</url>"
    - "                    <releases>"
    - "                        <enabled>true</enabled>"
    - "                    </releases>"
    - "                    <snapshots>"
    - "                        <enabled>true</enabled>"
    - "                    </snapshots>"
    - "                </pluginRepository>"
    - "            </pluginRepositories>"
    - "        </profile>"
    - "    </profiles>"
    - ""
    - "    <activeProfiles>"
    - "        <activeProfile>josephredmond-profile</activeProfile>"
    - "    </activeProfiles>"
    - ""
    - "    <servers>"
    - "        <server>"
    - "            <id>josephredmond-releases</id>"
    - "            <username>jredmondjr</username>"
    - "            <password>Emoticon0-Crazed4-Slug8-Headset6-Unluckily7-Acrobat6-Rewind1-Numeral5-Punctuate1-Woven5</password>"
    - "        </server>"
    - "    </servers>"
    - ""
    - "    <mirrors>"
    - "        <mirror>"
    - "            <id>central-mirror</id>"
    - "            <mirrorOf>central</mirrorOf>"
    - "            <url>https://repo.maven.apache.org/maven2/</url>"
    - "        </mirror>"
    - "    </mirrors>"
    - ""
    - "</settings>' > ~/.m2/settings.xml"
    - "mvn clean deploy"
    cached_dirs:
    - "/root/.m2/repository"
    ignore_errors: true
    shell: "BASH"
  - action: "mvn doxygen:generate"
    type: "BUILD"
    docker_image_name: "library/ubuntu"
    docker_image_tag: "20.04"
    execute_commands:
    - "sudo apt install doxygen"
    - "mvn doxygen:clean"
    - "mvn doxygen:generate"
    shell: "BASH"
